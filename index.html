<!doctype html>
<html class="no-js" lang="">
    <head>
        <!-- <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>Memory Game</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <script src="index.js"></script> -->
        <link rel="stylesheet" type="text/css" href="style.css">



    </head>
    <body>
      <!-- when i use js i'll connect it to score and update value that is contained within the element with the class of score -->
      <div class="topBar">
        Score: <span class="score">0</score>
        <span class="message"></span>
        </div>
        <!-- game play container -->
        <div class="container">
          <div class="startButton">Start Game</div>
          <!-- player's ship -->
          <div class='myShip'></div>
          <div class="fireme hide"></div>
        </div>
        <script>
        // connecting everything to javascript
        // start button obj: connecting it to the obj and making that connection with querySelector
        // this allows to interact with the content thats on the page; interacte using document object model and connecting to that instance of that element
        // btn_start will be representing the div startButton obj and the obj is the element with class of startButton
        // include a prefex for class; class is '.' id its '#', for tag its the tag name on its own
          const btn_start=document.querySelector(".startButton");
          // make connection with ship; it's what the players are going to move around
          const myShip = document.querySelector(".myShip");
          const container = document.querySelector(".container");
          const fireme = document.querySelector(".fireme");
          // variable for score, to let the use know the score everytime it changes
          const scoreOutput = document.querySelector(".score");
          // function getBoundingClientRect() provides usefull info such as height, width, top, bottom, can be used to utilize while setting up the boundaries
          // used function getBoundingClientRect() in order to get the main container
          const containerDim = container.getBoundingClientRect();
          const message = document.querySelector(".message");
          // added an event listener (it's a 'click' called startGame) to the start button so i've an option to start the game whenever possible;
          btn_start.addEventListener("click", startGame);
          // setup a global object / player obj  to hold all the useful player information
          // setup default variables within the player obj
          let player = {
            score :0,
            speed : 5,
            gameOver : true,
            fire: false,
            alienSpeed : 5
          }

          // setup another main object to control the key pressed
          let keyV = {};
          // using the document obj, adding an event listener to the entire document; listenering for event of "keyDown"
          // and if any of the keys are pressed on the keyboard, it'll invoke the keydown function
          document.addEventListener("keydown",function(e){
            // console.log(e);         //if you press a key, the console shows which key got pressed; so for space the keycode is 32
            // use the event obj and keyCode to retrieve the key information
            let key = e.keyCode;
            // console.log(key);           //only shows the keyCode
            // indicator for which direction and also listen for the keyUp and set those value to false
            if(key === 37){keyV.left=true;}
            else if (key===39) {keyV.right = true;}
            else if (key===38 || key===32) {
              if(!player.fire){addShoot();}  //invoked when the keys get pressed; function addShoot

            }
              // player fire is set to true if any of the below keys were pressed
              // console.log(keyV);
          })

          // listen for the keyUp and set those value to false
          document.addEventListener("keyup",function(e){
            let key = e.keyCode;
            if(key === 37){
              keyV.left=false;
            }
            else if (key===39) {
              keyV.right = false;
            }
            // console.log(keyV);
          })

          function gameOver(){
            btn_start.style.display = 'block';
            btn_start.innerHTML = "Restart New Game";
            player.fire = true;
            fireme.classList.add("hide") //updating the classList and adding in hide
          }

          function clearAliens(){
            let tempAliens = document.querySelectorAll(".alien");
            // loop throughwhen we start the game, it'll clear the allien whenit hits the end
              for(let x=0; x < tempAliens.length; x++){
                //as i loop through the tempAliens the index value x, selecting the element; taking the parentNode, moving up 1 level, in this case its the container
                tempAliens[x].parentNode.removeChild(tempAliens[x]);
              }
          }

          function startGame(){
            //  checking to see if player gameOver is true & if it is, start the game
            if (player.gameOver) {
              clearAliens();                 //start the game 1st thing to do is run clearAliens
              // set it to false so we can keep restarting until i want the user to restart
              player.gameOver = false;
              btn_start.style.display = 'none';
              // make sure the alien speed is at 5
              player.alignSpeed = 5;
              player.score=0;
              player.fire = false;
              scoreOutput.textContent=player.score;             //update and output the score content
              // pass in 5 aliens to setup
              setupAliens(20);
              messageOutput('Start Game');
              // within the global obj; this'll call and invoke a function as an animation frame
              player.animFrame = requestAnimationFrame(update);
            }
            // repeat animation game
            // this function needs to be selected using a global obj
          }


          function setupAliens(num){
            // make temporary width
            let tempWidth = 40;
            let lastCol = containerDim.width - tempWidth;
            // setup row obj to position the alien
            let row = {
              // pass in x & y obj value; x -- take the last col value,
              // use %100 to get a modules number & divide it by 2. Constantly adjest the values as i add more values
              // x : (lastCol % 100)/2,
              x: containerDim.left+50,
              // tafjest y value as i loop through and create more aliens
              y : 50
            }
            // make temporary width
            // let tempWidth = 100; -- move it up
            for (let x=0; x<num; x++){
              if (row.x > (lastCol - tempWidth)) {
                row.y += 70;
                // row.x = (lastCol % 100)/2          -- update the reset value
                row.x = containerDim.left+50
              }
              //  check to see if update in the position is possible before making the aliens
              alienMaker(row, tempWidth);
              row.x += tempWidth + 25;
            }
          }
// create a function for random color, it'll give random color
          function randomColor(){
            // Math.random()--it generates a huge string(0.5532452521)
            // .toString(16)===transform it into an string obj & 16 will make it an hex(so they can be #s or digits)
            // value(ex: "0.9d1eeef626315") .substr(-6)===gives us just the six characters from there(ex: "9e0dd1").
            return "#" + Math.random().toString(16).substr(-6)                    //return back a random color just by adding # to it

          }

          function alienMaker(row, tempWidth){
            //makes it more responsive for smaller screen
            if(row.y > (containerDim.height - 200)){
              return;
            }
            // creatingof div
            let div = document.createElement("div");
            // adding class to the div; content
            div.classList.add("alien")
            div.style.backgroundColor= randomColor();                 //ech one of the aliens have different color

            let eye1 = document.createElement("span");
            // take the classList and add an eye to it
            eye1.classList.add("eye");
            eye1.style.left ="5px";
            div.appendChild(eye1);
            // we need another eye, so each alien should need 2 eyes.
            let eye2 = document.createElement("span");
            eye2.classList.add("eye");
            eye2.style.right ="5px";
            div.appendChild(eye2);

            // Style for the mouth
            let mouth = document.createElement("span")
            // ass the class of mouth
            mouth.classList.add("mouth");

            div.appendChild(mouth)

            // set style property; set the px, it wont set numeric value otherwise.
            div.style.width= tempWidth+"px";
            div.xpos = Math.floor(row.x);
            div.ypos = Math.floor(row.y);
            // set its left position
            div.style.left = div.xpos+"px";
            div.style.top = div.ypos+"px";
            // direction moving, wheneve the aliens get to the end, i want go the other way
            // accomplish that using the variable 1 variable, multiplying it by -1, the 1 will turn into nagetive and move it other way
            // it happens everytime it hits (left and right) the end. when it hits the other way, it moves the oposite way turn the -1 back to 1
            div.directionMove=1;
            // append a Child to container obj; the Child is the div that i just created
            container.appendChild(div)

          }


          // Setup firing object, also the position where its starting
          function addShoot(){
            player.fire = true;
            fireme.classList.remove("hide");            //selectTheElement.UpdatingTheClassList.removingTheClassOfHide
            //select an obj and create a value of 'xpro' in that object; myShip.offsetLeft -- gives the position of where the ship is locate on the screen;
            fireme.xpos = (myShip.offsetLeft + (myShip.offsetWidth/2));          //myShip.offsetWidth/s --- starts half way into myShip, half way positioning where our x position is
            // y position; default position of where the fire is starting -- myShip.offsetTop - 10;
            fireme.ypos = myShip.offsetTop - 10;
            // update style properties
            fireme.style.left = fireme.xpos + "px";
            fireme.style.top = fireme.ypos + "px";
          }
          // cheking for collition; rect === rectangle
          function isCollide(a,b){
            let aRect = a.getBoundingClientRect();
            let bRect = b.getBoundingClientRect();
            // check to see if there's no overlap
            return !(
              (aRect.bottom < bRect.top) ||
              (aRect.top > bRect.bottom) ||                   //check for overlaps
              (aRect.right < bRect.left) ||
              (aRect.left > bRect.right)
            )
          }


          function messageOutput(mes){          //pass in value
            message.innerHTML = mes;             //use that within the message obj and update the innerHTML
          }

          // annimation function
          // repeat fuction, which let the game play over and over again; this will the updates that we need within the the game play area.
          // so effectively creating the annimation by running and constantly calling into the function
          function update(){
            if (!player.gameOver) {
            // select all the elements on the page that have a class of alien
            let tempAliens = document.querySelectorAll(".alien");
            if(tempAliens.length == 0){
              player.gameOver = true;
              messageOutput("You Won");
              gameOver();
            }
            // loop through the node list
            // x=tempAliens.length-1 === because it's moving backward; x > -1 === checking if x is larger than 1; x-- === subtracting 1 so we can break through the loop
            for(let x=tempAliens.length-1; x > -1; x--){
              // setup a variable called el and this'll be the tempAliens selecting tempAliens[item] from the arr list
              let el = tempAliens[x];                     //selected the alien element
              // check for crossover bt the alien and fireme elements; pass in 2 objects; fireme element is the only1 that got the projuctile
              if (isCollide(el,fireme)) {                     //check for fireme position and its top, left, and corner position
                messageOutput("HIT");
                player.alienSpeed++;                      // increment the speed each time the user hits an alien
                player.score++;                           //update score by 1
                scoreOutput.textContent=player.score;
                player.fire=false;
                fireme.classList.add("hide");               // hide the element(alien) that gets hit
                el.parentNode.removeChild(el);             // remove a child from the parentNode and remove the child matching those element values; this's the element that trigger the collision
                fireme.ypos = containerDim.height + 100;    //update the fire value

              }
              // check to see if the alien move off of ofset of the container dim width position & check the offsetwidth of the alien; also or el's x position is less then 0===containerDim.left;
              if(el.xpos > (containerDim.width - el.offsetWidth) ||
                el.xpos < containerDim.left){
                // if that's true change direction by multiplying it with -1 & -1 *1 = 1 -1* -1 = 1; flip between 1 & -1
                el.directionMove *= -1;                         // direction moving position
                el.ypos += 40;                                   // want the alien to move down, incremented by 40
                // checking to see if the alien hits the bottom; if yes GAME OVER
                if (el.ypos > myShip.offsetTop - 50){                         // looking for the value of myShip and get a value of offsetTop position (-20) so if it hits lil above the ship, it'll be grame over
                  messageOutput("Game Over");
                  player.gameOver=true;
                  gameOver();                       //invoke game over function
                }
              }
              // gives the ability to move the aliens ; same as the myShip
              el.xpos += (player.alienSpeed * el.directionMove);            //give the direction if moveing left or right
              el.style.left = el.xpos+"px";
              el.style.top = el.ypos+"px";
            }



            // temporary value position ; it get the left position in a pixel value in a numeric value
            let tempPos = myShip.offsetLeft;
            // check to see if player fire is true, we can take can action according to that
            if (player.fire) {
              if (fireme.ypos > 0) {
                fireme.ypos -= 15;
                fireme.style.top = fireme.ypos + "px";
              } else {
                player.fire = false;
                fireme.classList.add("hide");
                fireme.ypos = containerDim.height + 100;
              }
            }
            // can tempPos to update it; if key pressed left & see if the value of the left position is greater the container boundaries, subtract player speed  of it
            if (keyV.left && tempPos > containerDim.left) {
              tempPos -= player.speed;
            }
            // if key value is right then move it to the right by adding
            if (keyV.right && (tempPos + myShip.offsetWidth) < containerDim.right) {
              tempPos += player.speed;
            }
            // select the myShip obj dynamiclly update its style value, using tempPos & updating its pix location
            myShip.style.left = tempPos + "px";

              player.animFrame = requestAnimationFrame(update);       //constantly loop through update

            }
            // console.log("player");
          }


        </script>


        <!-- <button class="myButton" onclick="sayHello()">Click Me</button> -->


    </body>
